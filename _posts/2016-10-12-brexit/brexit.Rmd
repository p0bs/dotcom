---
title: "Brexit vote analysis"
author: Robin Penfold
date: 2016-10-12
categories:
  - politics
  - geoviz
draft: true
preview: hex.jpeg
slug: brexit
description: |
  ADD ...
output:
  distill::distill_article:
    self_contained: false
    highlight: pygments
---

```{r brexit, echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}
suppressMessages(library(tidyverse))
library(ggiraph)
library(parlitools)

map_details <- west_hex_map

brexitData <- leave_votes_west %>% 
  mutate(leave_vote = figure_to_use) %>% 
  left_join(
    map_details,
    by = c("ons_const_id" = "gss_code")
    ) %>% 
  mutate(
    constituency = ifelse(
      is.na(constituency_name.x), 
      constituency_name.y, 
      constituency_name.x
      )
  ) %>% 
  select(constituency, leave_vote, party_2016, ons_const_id, geometry) %>% 
  arrange(constituency)

gg <- brexitData %>% 
  ggplot() + 
  geom_sf_interactive(
    aes(
      group = constituency,
      geometry = geometry,
      fill = leave_vote,
      colour = party_2016,
      tooltip = paste0(
        constituency, 
        "\n MP: ",
        party_2016,
        "\n Leave vote: ",
        round(leave_vote * 100, 0),
        "%"
        )
    )
  ) + 
  scale_fill_gradient2_interactive(
    low = "green", 
    mid = "white", 
    high = "orange", 
    midpoint = 0.5
    ) +
  scale_colour_manual_interactive(
    values = c(
      Conservative = "#0087DC",
      DUP = "#D46A4C",
      Independent = "#AFAFAFAF",
      Other = "#AFAFAFAF",
      SDLP = "#AFAFAFAF",
      UKIP = "#AFAFAFAF",
      UUP = "#AFAFAFAF",
      Labour = "#DC241F",
      `Liberal Democrat` = "#FDBB30",
      `Plaid Cymru` = "#008142",
      `Scottish National Party` = "#FFFF00",
      `Sinn Fein` = "#008800",
      Green = "#6AB023"
    )
  ) +
  theme_void() +
  labs(
    title = "Brexit vote by constituency", 
    subtitle = "Hover over a point for more information"
  ) + 
  theme(
    legend.position = "right"
    )

girafe(ggobj = gg)
```

</br>


##   {.appendix}

For completeness (and reproducibility), here's the code that I used to calculate what's above.

```{r brexit, eval=FALSE, echo=TRUE}
```

## System settings {.appendix}

```{r, eval=TRUE, echo=FALSE}
sessionInfo()
```